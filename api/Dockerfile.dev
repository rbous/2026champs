# Development Dockerfile with hot reloading
FROM golang:1.24-alpine

WORKDIR /app

# Install git for dependencies
RUN apk add --no-cache git

# Install air for hot reloading
RUN go install github.com/air-verse/air@latest

# Copy go mod files from the api directory (context is repository root)
COPY api/go.mod api/go.sum ./

# Download dependencies
RUN go mod download

# Copy source code from the api directory
COPY api/ .

# Ensure no vendor folder exists if it was accidentally copied
RUN rm -rf vendor

# Expose port
EXPOSE 8080

# Run with air for hot reloading
CMD ["air", "-c", ".air.toml"]